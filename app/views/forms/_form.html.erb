
<script>
var toggleShow = function(checked, id) {
	checked ? $("#"+id).show() : $("#"+id).hide();
}

// html related
var getChecked = function(group_id) {
	return $('#form_'+group_id).prop("checked");
}

// html related
var toggleChange = function() {
	var groups = [
		"tg", "og", "cg", "pg"
	]

	var count = 0;

	for (var i = 0 ; i < groups.length; ++i)
		count += getChecked(groups[i]);

	var no_more = count >= 2 ? 1 : 0;

	if (no_more) {
		for (var i = 0 ; i < groups.length; ++i) {
			if (! getChecked(groups[i])) $("#form_"+groups[i]).attr("disabled", true);
		}
	} else {
		for (var i = 0 ; i < groups.length; ++i) {
			$("#form_"+groups[i]).removeAttr("disabled");
		}
	}
}

var toggleCheck = function(checked, id) {
	toggleShow(checked, id);
	toggleChange();
}

</script>

<%= form_for(@form, :validate => true) do |f| %>
  <% if @form.errors.any? %>
    <div id="error_explanation">
      <h2>发生了以下错误，请修改后再次提交</h2>
      <ul>
      <% @form.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
  <div class="field">
    <div>
      <%= f.label :name %>
    </div>
    <%= f.text_field :name %>
  </div>
  <div class="field">
    <div><%= f.label :tel %></div>
    <span class='tip'>如果既有长号又有短号，可以用空格分开，类似这样: <code>15900000000 590000</code></span>
    <div><%= f.text_field :tel %></div>
  </div>
  <div class="field">
    <div><%= f.label :major %></div>
    <span class='tip'>专业和年级，用空格分开。例如: <code>工科平台 <%= Time.now.strftime('%y') %></code></span>
    <div><%= f.text_field :major %></div>
  </div>
  <div class="field">
    <div><%= f.label :gender %></div>
    <%= f.select :gender, options_for_select([ [ '男', 1 ], [ '女', 2 ] ], @form.gender) %>
  </div>
  <div class="field">
    <div><%= f.label :campus %></div>
    <%= f.select :campus, options_for_select([ [ '紫金港', 1 ], [ '玉泉', 2 ] ], @form.campus) %>
  </div>
  <div class="field">
    <div><%= f.label :email %></div>
    <span class='tip'>不要填写 <code>st.zju.edu.cn</code> 的邮箱</span>
    <div><%= f.text_field :email %></div>
  </div>
  <div class="field">
    <div><%= f.label :forum_id %></div>
    <span class='tip'><%= link_to 'CC98', 'http://www.cc98.org', target: '_blank' %> 是校园内网主要论坛，是 MSTC Staff 线上交流的重要平台之一</span>
    <div><%= f.text_field :forum_id %></div>
  </div>
  <p>勾选你感兴趣的 Group<br> 
  <span class='tip'>可以多选，但不要超过两个。在目标明确的情况下，我们推荐只选一个。
    <br>不知道如何选？请查看 <%= link_to 'MSTC 简介中关于 Group 的介绍', "#{about_url}#groups", :target => "_blank" %>
    <br>或者，前往 <%= link_to 'CC98 MSTC 版面', 'http://www.cc98.org/list.asp?boardid=60', target: '_blank' %> 中 <%= link_to '纳新答疑专楼', 'http://www.cc98.org/dispbbs.asp?boardID=60&ID=2316283', target: '_blank' %> 发贴询问
  </span></p>
  <div class="field">
    <%= f.check_box :tg, :class => "group_check", :onchange => 'toggleCheck(this.checked, "tg_field")' %>
    <%= f.label :tg, class: 'group_label' %>
    <br/>
    <span class='tip'>主要负责俱乐部的技术活动，如活动主讲人、参与 GIP 活动、代码编写与维护、参与微软的编程实践项目等</span>
    <br><span class='tip'>注意：MSTC 绝大部分活动是所有成员都可以参与的，在任何 Group 都能接触到 MSTC 所有成员及资源，只要有热心就可以收获好朋友。如果在技术上一般，建议选择其他 Group。当然，Technology Group 对不同年级的学生有不同的要求。</span>
  </div>
  <div class="field">
    <%= f.check_box :og, :class => "group_check", :onclick => 'toggleCheck(this.checked, "og_field")'%>
    <%= f.label :og, class: 'group_label' %>
    <br/>
    <span class='tip'>主要负责俱乐部的日常运作事务，如活动总结、财务以及和微软亚洲研究院的沟通等</span>
  </div>
  <div class="field">
    <%= f.check_box :cg, :class => "group_check", :onclick => 'toggleCheck(this.checked, "cg_field")' %>
    <%= f.label :cg, class: 'group_label' %>
    <br/>
    <span class='tip'>主要负责俱乐部内的文化活动，如组织俱乐部内的吃喝玩乐、POM 活动等</span>
  </div>
  <div class="field">
    <%= f.check_box :pg, :class => "group_check", :onclick => 'toggleCheck(this.checked, "pg_field")'%>
    <%= f.label :pg, class: 'group_label' %> 
    <br/>
    <span class='tip'>主要负责俱乐部的宣传，如海报、传单、刊物的制作等</span>
  </div>
  <hr />
  <div class="field">
      <span class='tip'>以下内容请<strong>尽可能详细填写</strong>，以便让我们在面试前更好的了解你！</span>
  </div>
  <div id="tg_field"><%= f.label :tg_q %>
    <div class="field">
      <div><%= f.label :tg_q1 %></div>
      <%= f.text_area :tg_q1 %>
    </div>
    <div class="field">
      <div><%= f.label :tg_q2 %></div>
      <div><%= f.text_area :tg_q2 %></div>
    </div>
    <div class="field">
      <div><%= f.label :tg_q3 %></div>
      <div><%= f.text_area :tg_q3 %></div>
    </div>
    <div class="field">
      <div><%= f.label :tg_q4 %></div>
      <div><%= f.text_area :tg_q4 %></div>
    </div>
    <hr />
  </div>
  <div id="pg_field"><%= f.label :pg_q %>
    <div class="field">
      <div><%= t 'activerecord.attributes.form.pg_q1_html' %></div>
      <%= f.text_area :pg_q1 %>
    </div>
    <div class="field">
      <div><%= f.label :pg_q2 %></div>
      <div><%= f.text_area :pg_q2 %></div>
    </div>
    <div class="field">
      <div><%= f.label :pg_q3 %></div>
      <div><%= f.text_area :pg_q3 %></div>
    </div>
    <hr />
  </div>
  <div id="og_field"><%= f.label :og_q %>
    <div class="field">
      <div><%= f.label :og_q1 %></div>
      <%= f.text_area :og_q1 %>
    </div>
    <div class="field">
      <div><%= f.label :og_q2 %></div>
      <div><%= f.text_area :og_q2 %></div>
    </div>
    <div class="field">
      <div><%= f.label :og_q3 %></div>
      <div><%= f.text_area :og_q3 %></div>
    </div>
    <hr />
  </div>
  <div id="cg_field"><%= f.label :cg_q %>
    <div class="field">
      <div><%= f.label :cg_q1 %></div>
      <%= f.text_area :cg_q1 %>
    </div>
    <div class="field">
      <div><%= f.label :cg_q2 %></div>
      <div><%= f.text_area :cg_q2 %></div>
    </div>
    <div class="field">
      <div><%= f.label :cg_q3 %></div>
      <div><%= f.text_area :cg_q3 %></div>
    </div>
    <hr />
  </div>
  <div class="actions">
    <%= f.submit '确认提交' %>
  </div>
  <script>
    toggleShow($("#form[tg]").value, "tg_field");
    toggleShow($("#form[og]").value, "og_field");
    toggleShow($("#form[pg]").value, "pg_field");
    toggleShow($("#form[cg]").value, "cg_field");
	toggleChange();
  </script>

<% end %>
